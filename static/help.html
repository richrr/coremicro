<!DOCTYPE html>
<html>
  <head>
    <!-- Required for bootstrap -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous">
    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
    
    <title>Core Microbiome</title>
    <link rel="stylesheet" type="text/css" href="stylesheets/main.css">
  </head>
  <body>
    <div id="content">
      <a href="/">back</a>
      <h1>Documentation</h1>
      The COREMIC tool is a webtool hosted on google app engine and written in python.
      For details about the algorithm used in the tool, please refer to and cite:
      <....>
        
        <h2>Table of Contents</h2>
        <ol>
	  <li><a href="#input_files">Input files</a></li>
	  <li><a href="#options">Options</a></li>
          <li><a href="#outputs">Output Files</a></li>
	  <li><a href="#method">Method details</a></li>
          <li><a href="#sample_data">Sample Data</a></li>
	  <li><a href="#faq">FAQs</a></li>
        </ol>
	<h2 id="input_files">Input files</h2>
	The tool needs exactly two input files
  	<h3>Datafile</h3>
  	The file basically contains abundance information of OTUs across 
	samples. Please refer <a href="http://biom-format.org/index.html">here</a> for 
	details of the BIOM format, why it is useful, or how to convert from traditional 
	tab delimited OTU table to BIOM format file.<br>
	
	<b>Please make sure the header "taxonomy" is present and each OTU taxonomy is unique.</b>
	Most often this file would be an output from the OTU picking step from QIIME or 
	other tools. A QIIME 1.8 compatible sample 
	<a href="http://biom-format.org/documentation/format_versions/biom-1.0.html">
	  BIOM 1.0 format file</a> looks like:
	<pre>
          {
          "id": "None",
          "format": "Biological Observation Matrix 1.0.0",
          "format_url": "http://biom-format.org",
          "type": "OTU table",
          "generated_by": "BIOM-Format 1.3.1",
          "date": "2016-01-14T19:49:54.900111",
          "matrix_type": "sparse",
          "matrix_element_type": "float",
          "shape": [678, 59],
          "data": [[0,0,4.0],
	  [0,1,2.0],
	  [0,6,1.0],
	  [0,7,10.0],
	  ...
	  [677,55,18.0],
	  [677,56,33.0],
	  [677,57,8.0],
	  [677,58,14.0]],
          "rows": [{"id": "1", "metadata": {"taxonomy": "k__Bacteria"}},
	  {"id": "2", "metadata": {"taxonomy": "k__Bacteria;p__Acido...;f__;g__;s__"}},
	  {"id": "3", "metadata": {"taxonomy": "k__Bacteria;p__Basido...;f__;g__;s__"}},
    	  {"id": "4", "metadata": {"taxonomy": "k__Bacteria;p__Proteo...;f__;g__;s__"}},
	  ...
   	  {"id": "675", "metadata": {"taxonomy": "k__Bacteria;p__WS3...;f__XYZ;g__;s__"}},
	  {"id": "676", "metadata": {"taxonomy": "k__Bacteria;p__WS3...;f__PRR;g__;s__"}},
	  {"id": "677", "metadata": {"taxonomy": "k__Bacteria;p__WS3...;f__;g__;s__"}},
    	  {"id": "678", "metadata": {"taxonomy": "Unassigned"}}],
          "columns": [{"id": "SAMP1", "metadata": null},
	  {"id": "SAMP1", "metadata": null},
	  {"id": "SAMP2", "metadata": null},
	  ...
	  {"id": "SAMP58", "metadata": null},
	  {"id": "SAMP59", "metadata": null}]
          }
        </pre>
	
	
	<h3>Group file</h3> 
	This <b>tab-delimited</b> file contains information 
	about the samples and the groups to which they belong.<br>
        
	<b>Please make sure the group of interest "Person" is binary ("Good" vs "Bad").
	  "#SampleID" and a group of interest columns are required.</b> Other columns
	are optional (e.g.BarcodeSequence, LinkerPrimerSequence, Description). 
	Most often this file would be an input to the OTU picking step from QIIME or 
	other tools. A QIIME 1.8 compatible sample 
	<a href="http://qiime.org/documentation/file_formats.html#mapping-file-overview">
	  group file</a> looks like:
        
	<pre>
          #SampleID	Person
          SAMP1	Good
          SAMP2	Good
          ...
          SAMP58	Bad
          SAMP59	Bad
	</pre>
        
        <h2 id="options">Options</h2>
        These are some of the options that need to provided:
        <dl>
          <dt>Name for output/label</dt>
          <dd>This helps you to keep track of what this run indicates. It will be included in 
            name of all attached result files and the subject of all emails about your run.</dd>
          <dt>Interest group</dt>
          <dd>Enter ":" delimited EXACT string of the interest group on which you want core 
            microbiome analysis to be performed. For example, to calculate core microbiome of
            "Good" under the "Person" group (column), enter "Person:Good".</dd>
          <dt>Include Out-Group Results</dt>
          <dd>Whether the results of running the processing on the out-group should be included
            in the email as well. This is equivalent to re-running the processing with the
            interest group not selected in the previous field. For example, Person:Bad, rather
            than Person:Good.</dd>
          <dt>Number of randomizations</dt>
          <dd>Used to estimate the significance of core OTUs. Please keep this number greater
            than 500 and less than a 1500. 1000 is a good default.</dd>
          <dt>Randomization Type</dt>
          <dd>
            How to randomize the data
            <ul>
              <li>Sample Annotation: Keeps the data table and otu labels the same, only shuffles the sample annotations (default)</li>
              <li>Row Wise: For each row (otu), shuffles the numbers</li>
              <li>Column Wise: For each column (sample), shuffles the numbers</li>
              <li>OTU Label: Keeps the data table and sample annotation the same, only shuffles the otu taxonomies</li>
            </ul>
          <dt><i>p</i>-value adjustment method</dt>
          <dd>To correct for multiple testings of OTUs. Benjamini Hochberg is a good default.</dd>
          <dt>Email</dt>
          <dd>The email address where you want your results emailed. <b>Your results are NOT 
              stored;</b> you will only get these results via email. </dd>
        </dl>

        <h2 id="outputs">Output Files</h2>
        <p>When the tool is finished running the results will be emailed to the email address it
          was given. The results of the analysis are attached to the email as a .tsv file, which
          can be opened in a number of programs including Excel. The first column lists the OTUs
          that were found to be in the core-microbiome of the interest group. These are divided up
          into buckets based on what threshold they met. For each significant OTU the number of
          times it was found in the randomized data, the p-value initially calculated, and the
          p-value adjusted using the specified method. If the option to run analysis on the
          out-group was selected as well then a second .tsv file will be attached containing those
          results.
        </p>
        
        <h2 id="method">Method Details</h2>
        Currently, the tool uses presence absence data to identify core microbiome OTUs.
        <br>
        <img src="images/ms3-core-microb-overflow-latest-orig-data-details-all-data-6.jpg" 
             alt="Algorithm" style="width:604px;height:450px;"> <br>
        
        Future versions of this tool will include more complicated algorithms.

        <h2 id="sample_data">Sample Data</h2>
        A sample datafile can be downloaded <a href="sample_data/otu_table_16s.biom">here</a> and a
        sample groupfile can be downloaded <a href="sample_data/sample-sheet-qiime.txt">here</a>.
        
        <h2 id="faq">FAQs</h2>
        <h3>How long does it take to run?</h3>
        <p>When run for 1000 itterations on the provided sample data, which has 59 samples and 678 OTUs,
          it takes about five minutes to run on the default settings. It may take longer for your data to
          run in some cases, such as if it is a significantly larger dataset or we suddenly recieve a large
          number of requests.</p>

        <h3>What browsers are supported?</h3>
        <p>All of the processing is done on our server, so all browsers should be able to use this tool.
          The form does use some HTML5 features to help you make sure the information you put in is correct;
          these are not supported in some older browsers such as Internet Explorer 8, and are only partialy
          supported in Safari.</p>

        <h3>Why didn't I get my results?</h3>
        <p>If you have waited a very long time (over an hour) and still haven't recieved your results check
          your spam folder to make sure they didn't end up in there. If your results are not in your spam folder
          either send us an email with your input parameters and when you submitted your task and we will
          try to figure out what went wrong.</p>

        <h3>Can I provide the seed for randomization?</h3>
        <p>Unfortunately this feature is not currently available. We are looking into adding it however, so that
          you can reproduce results from the tool.</p>
        
        For questions or feature requests, please email <a href="mail:markwill@vt.edu">
          markwill@vt.edu</a>
        
        
        <!-- Scripts for Bootstrap -->
        
        <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    </div>
  </body>
</html>
